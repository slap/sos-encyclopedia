---
layout: polypage
title: Sum of squares length of real forms
author: C. Scheiderer
name: soslength
tags: [motzkin, classical, nonnegative, sos-decomposition]
---

The paper "Sum of Squares Length of Real Forms" by Claus Scheiderer gives lower bounds for the Pythagoras number $p(n,2d)$, by constructing explicit examples of
polynomials with the given length. This polynomials are constructed as generic sums of squares of polynomials vanishing in a generic set of points.

The construction can be used to build polynomials of any degree and number of variables.

We construct some polynomials for specific $n$ and $d$ that verify the lower bounds given in that paper.

We verified using numerical computations that the generated polynomials have indeed the predicted length.

Case $n = 4$, $d=2$. Sum of $5$ polynomials with unique SOS decomposition ($s = 5$).

```
p[1] := -(9/13)*x[1]^2+(7/13)*x[1]*x[2]-(9/26)*x[1]*x[3]-x[1]*x[4]-(10/13)*x[2]^2+x[4]^2;
p[2] := (17/13)*x[1]^2-(6/13)*x[1]*x[2]+(17/26)*x[1]*x[3]+2*x[1]*x[4]+(3/13)*x[2]^2+x[3]*x[4];
p[3] := (9/13)*x[1]^2+(6/13)*x[1]*x[2]+(61/26)*x[1]*x[3]-(3/13)*x[2]^2+x[3]^2;
p[4] := -(18/13)*x[1]^2+(14/13)*x[1]*x[2]-(9/13)*x[1]*x[3]-2*x[1]*x[4]-(7/13)*x[2]^2+x[2]*x[4];
p[5] := -(10/13)*x[1]^2+(2/13)*x[1]*x[2]-(5/13)*x[1]*x[3]+(12/13)*x[2]^2+x[2]*x[3];
# Sum of squares
pp := add(p[i], i = 1..5);
```

Case $n = 4$, $d=3$. Sum of $8$ polynomials with unique SOS decomposition ($s = 12$).

```
p[1] := -(375/496)*x[1]^3+(2375/1984)*x[1]^2*x[2]+(461/1984)*x[1]^2*x[3]-(785/992)*x[1]^2*x[4]+(97/64)*x[1]*x[2]^2-(107/1488)*x[1]*x[2]*x[3]+(4475/5952)*x[1]*x[2]*x[4]-(2509/5952)*x[1]*x[3]^2-(5159/5952)*x[1]*x[3]*x[4]+(957/992)*x[1]*x[4]^2-(7/16)*x[2]^3+(9/16)*x[2]^2*x[3]+x[4]^3;
p[2] := (101/248)*x[1]^3-(1363/992)*x[1]^2*x[2]-(785/992)*x[1]^2*x[3]-(87/496)*x[1]^2*x[4]-(45/32)*x[1]*x[2]^2-(35/744)*x[1]*x[2]*x[3]-(1135/2976)*x[1]*x[2]*x[4]+(1121/2976)*x[1]*x[3]^2+(1099/2976)*x[1]*x[3]*x[4]-(289/496)*x[1]*x[4]^2+(3/8)*x[2]^3-(5/8)*x[2]^2*x[3]+x[3]*x[4]^2;
p[3] := (21/31)*x[1]^3+(1049/496)*x[1]^2*x[2]+(515/496)*x[1]^2*x[3]+(187/248)*x[1]^2*x[4]+(19/16)*x[1]*x[2]^2+(413/186)*x[1]*x[2]*x[3]+(1769/1488)*x[1]*x[2]*x[4]-(955/1488)*x[1]*x[3]^2+(643/1488)*x[1]*x[3]*x[4]+(19/248)*x[1]*x[4]^2-(1/4)*x[2]^3+(3/4)*x[2]^2*x[3]+x[3]^2*x[4];
p[4] := (13/31)*x[1]^3-(253/62)*x[1]^2*x[2]-(167/62)*x[1]^2*x[3]-(30/31)*x[1]^2*x[4]-(9/2)*x[1]*x[2]^2-(115/93)*x[1]*x[2]*x[3]-(91/186)*x[1]*x[2]*x[4]+(347/186)*x[1]*x[3]^2+(271/186)*x[1]*x[3]*x[4]-(43/31)*x[1]*x[4]^2-x[2]^2*x[3]+x[3]^3;
p[5] := -(75/248)*x[1]^3+(909/992)*x[1]^2*x[2]+(303/992)*x[1]^2*x[3]+(153/496)*x[1]^2*x[4]+(19/32)*x[1]*x[2]^2+(301/744)*x[1]*x[2]*x[3]-(655/2976)*x[1]*x[2]*x[4]-(415/2976)*x[1]*x[3]^2-(821/2976)*x[1]*x[3]*x[4]+(303/496)*x[1]*x[4]^2-(5/8)*x[2]^3+(3/8)*x[2]^2*x[3]+x[2]*x[4]^2;
p[6] := -(7/62)*x[1]^3-(211/496)*x[1]^2*x[2]+(95/496)*x[1]^2*x[3]+(67/248)*x[1]^2*x[4]+(7/16)*x[1]*x[2]^2-(2/31)*x[1]*x[2]*x[3]+(551/496)*x[1]*x[2]*x[4]+(227/496)*x[1]*x[3]^2+(493/496)*x[1]*x[3]*x[4]+(95/248)*x[1]*x[4]^2+(3/4)*x[2]^3-(1/4)*x[2]^2*x[3]+x[2]*x[3]*x[4];
p[7] := -(15/62)*x[1]^3+(63/124)*x[1]^2*x[2]+(21/124)*x[1]^2*x[3]+(3/31)*x[1]^2*x[4]-(1/4)*x[1]*x[2]^2+(85/186)*x[1]*x[2]*x[3]-(143/372)*x[1]*x[2]*x[4]+(67/372)*x[1]*x[3]^2+(107/372)*x[1]*x[3]*x[4]+(21/62)*x[1]*x[4]^2-x[2]^3+x[2]*x[3]^2;
p[8] := (55/62)*x[1]^3+(37/496)*x[1]^2*x[2]-(153/496)*x[1]^2*x[3]+(67/248)*x[1]^2*x[4]-(17/16)*x[1]*x[2]^2+(149/93)*x[1]*x[2]*x[3]+(1405/1488)*x[1]*x[2]*x[4]+(433/1488)*x[1]*x[3]^2+(1727/1488)*x[1]*x[3]*x[4]-(153/248)*x[1]*x[4]^2-(1/4)*x[2]^3+(3/4)*x[2]^2*x[3]+x[2]^2*x[4];

# Sum of squares
pp := add(p[i], i = 1..8);
pp := (121753451/5904384)*x[1]^3*x[2]^2*x[4]-(34239587/35426304)*x[1]^2*x[3]^2*x[4]^2+(16539127/2952192)*x[1]^2*x[2]*x[4]^3-(50184157/17713152)*x[1]^2*x[2]^2*x[3]^2-(63063161/5904384)*x[1]^3*x[3]^2*x[4]+(16171145/1476096)*x[1]^3*x[3]*x[4]^2+(138118499/17713152)*x[1]^2*x[3]^3*x[4]+(427315/15872)*x[1]^2*x[2]^3*x[3]+(201111257/5904384)*x[1]^4*x[2]*x[3]-(63484873/4428288)*x[1]^2*x[2]*x[3]^3+(27426163/1476096)*x[1]^3*x[2]*x[4]^2+(35805139/2952192)*x[1]^4*x[3]*x[4]+(938420317/35426304)*x[1]^2*x[2]^2*x[4]^2+(603065/63488)*x[1]^2*x[2]^3*x[4]+(28535/23808)*x[1]*x[2]^3*x[4]^2-(216207/15872)*x[1]*x[2]^2*x[3]^3+(4039/2976)*x[1]*x[2]^2*x[4]^3-(131/62)*x[1]*x[2]*x[3]^4+(8111/2976)*x[1]*x[2]*x[4]^4+(1213/744)*x[1]*x[3]^4*x[4]-(1721/1488)*x[1]*x[3]^3*x[4]^2+(145/2976)*x[1]*x[3]^2*x[4]^3-(8627/2976)*x[1]*x[3]*x[4]^4+3*x[2]^4*x[3]*x[4]-x[2]^3*x[3]^2*x[4]+(3/2)*x[2]^3*x[3]*x[4]^2+(3/2)*x[2]^2*x[3]^3*x[4]-(1/4)*x[2]^2*x[3]^2*x[4]^2+(9/8)*x[2]^2*x[3]*x[4]^3+(571225/246016)*x[1]^6+(617/256)*x[2]^6+x[3]^6+x[4]^6-(1996665/492032)*x[1]^5*x[2]-(1331187/492032)*x[1]^5*x[3]+(356367/246016)*x[1]^5*x[4]+(70479393/3936256)*x[1]^4*x[2]^2+(4310885/380928)*x[1]^4*x[3]^2-(2258227/984064)*x[1]^4*x[4]^2+(103265/2048)*x[1]^3*x[2]^3-(22367051/1968128)*x[1]^3*x[3]^3+(138651/492032)*x[1]^3*x[4]^3+(2755103/126976)*x[1]^2*x[2]^4-(29373983/35426304)*x[1]^2*x[3]^4+(2590721/984064)*x[1]^2*x[4]^4-(1039/512)*x[1]*x[2]^5+(347/93)*x[1]*x[3]^5+(957/496)*x[1]*x[4]^5-(327/128)*x[2]^5*x[3]-(1/2)*x[2]^5*x[4]+(265/256)*x[2]^4*x[3]^2-(1/4)*x[2]^4*x[4]^2-(7/8)*x[2]^3*x[4]^3-x[2]^2*x[3]^4+x[2]^2*x[4]^4+x[3]^4*x[4]^2+x[3]^2*x[4]^4-(1562567/984064)*x[1]^3*x[2]*x[3]*x[4]-(134997679/17713152)*x[1]^2*x[2]^2*x[3]*x[4]+(71898509/17713152)*x[1]^2*x[2]*x[3]^2*x[4]+(56411651/17713152)*x[1]^2*x[2]*x[3]*x[4]^2+(123313/11904)*x[1]*x[2]^3*x[3]*x[4]-(28871/47616)*x[1]*x[2]^2*x[3]^2*x[4]+(156743/23808)*x[1]*x[2]^2*x[3]*x[4]^2+(3685/744)*x[1]*x[2]*x[3]^3*x[4]+(6949/1488)*x[1]*x[2]*x[3]^2*x[4]^2-(515/744)*x[1]*x[2]*x[3]*x[4]^3+(34379321/2952192)*x[1]^4*x[2]*x[4]+(445111/47616)*x[1]*x[2]^3*x[3]^2+(305007949/5904384)*x[1]^3*x[2]^2*x[3]-(67861/47616)*x[1]*x[2]^4*x[4]-(20007955/2952192)*x[1]^2*x[3]*x[4]^3+(451249/47616)*x[1]*x[2]^4*x[3]-(60135007/5904384)*x[1]^3*x[2]*x[3]^2;
```

Case $n = 5$, $d=2$. Sum of $7$ polynomials with unique SOS decomposition ($s = 8$).

```
p[1] := (5/4)*x[1]^2+(1065/92)*x[1]*x[2]-(192/23)*x[1]*x[3]-(1299/92)*x[1]*x[4]-3*x[1]*x[5]-(185/46)*x[2]^2-(347/46)*x[2]*x[4]-(21/46)*x[3]^2+x[5]^2;
p[2] := (1/2)*x[1]^2+(79/23)*x[1]*x[2]-(271/138)*x[1]*x[3]-(153/46)*x[1]*x[4]-x[1]*x[5]-(39/23)*x[2]^2-(133/46)*x[2]*x[4]-(19/69)*x[3]^2+x[4]*x[5];
p[3] := (39/46)*x[1]*x[2]+(9/46)*x[1]*x[3]-(6/23)*x[1]*x[4]-(22/23)*x[2]^2-(65/46)*x[2]*x[4]-(2/23)*x[3]^2+x[4]^2;
p[4] := -x[1]^2-(168/23)*x[1]*x[2]+(124/23)*x[1]*x[3]+(195/23)*x[1]*x[4]+2*x[1]*x[5]+(48/23)*x[2]^2+(96/23)*x[2]*x[4]+(19/23)*x[3]^2+x[3]*x[5];
p[5] := -(21/23)*x[1]*x[2]+(4/23)*x[1]*x[3]+(10/23)*x[1]*x[4]+(6/23)*x[2]^2+(12/23)*x[2]*x[4]+(11/23)*x[3]^2+x[3]*x[4];
p[6] := -x[2]*x[4]+x[2]*x[5];
p[7] := -x[1]*x[2]+x[2]*x[3];

# Sum of squares
pp := add(p[i], i = 1..7);
pp := (45/16)*x[1]^4+(51605/2116)*x[2]^4+(22909/19044)*x[3]^4+x[4]^4+x[5]^4+(38/23)*x[3]^3*x[5]+(19/23)*x[3]^2*x[4]^2+(2/23)*x[3]^2*x[5]^2+x[4]^2*x[5]^2+(8645/184)*x[1]^3*x[2]-(4639/138)*x[1]^3*x[3]-(10227/184)*x[1]^3*x[4]-(25/2)*x[1]^3*x[5]+(1572489/8464)*x[1]^2*x[2]^2+(1896943/19044)*x[1]^2*x[3]^2+(2391613/8464)*x[1]^2*x[4]^2+(33/2)*x[1]^2*x[5]^2-(290625/2116)*x[1]*x[2]^3+(84475/4761)*x[1]*x[3]^3-(12/23)*x[1]*x[4]^3-6*x[1]*x[5]^3+(96149/1058)*x[2]^3*x[4]+(10019/1058)*x[2]^2*x[3]^2+(177831/2116)*x[2]^2*x[4]^2-(162/23)*x[2]^2*x[5]^2-(65/23)*x[2]*x[4]^3+(22/23)*x[3]^3*x[4]+(51167/3174)*x[2]*x[3]^2*x[4]-(292/23)*x[1]*x[3]*x[5]^2+(49739/529)*x[1]*x[2]^2*x[3]+(62507/2116)*x[1]*x[3]^2*x[4]+(5077/69)*x[1]^2*x[3]*x[5]-(124/23)*x[2]^2*x[4]*x[5]+(96/23)*x[2]^2*x[3]*x[5]-(2136897/4232)*x[1]^2*x[2]*x[4]+(29/23)*x[1]*x[3]*x[4]^2+(12/23)*x[2]^2*x[3]*x[4]-(103547/1058)*x[1]*x[2]^2*x[4]-(906197/3174)*x[1]^2*x[2]*x[3]-(1391/46)*x[1]*x[4]*x[5]^2+(5809/46)*x[1]^2*x[4]*x[5]+(360001/1058)*x[1]^2*x[3]*x[4]-(153/23)*x[1]*x[4]^2*x[5]+(647319/2116)*x[1]*x[2]*x[4]^2+(1199/69)*x[1]*x[3]^2*x[5]+(1065/46)*x[1]*x[2]*x[5]^2-(4855/46)*x[1]^2*x[2]*x[5]+(825/23)*x[1]*x[2]^2*x[5]-(162191/6348)*x[1]*x[2]*x[3]^2+(24/23)*x[2]*x[3]*x[4]^2-(133/23)*x[2]*x[4]^2*x[5]-(347/23)*x[2]*x[4]*x[5]^2-(38/69)*x[3]^2*x[4]*x[5]+(285830/1587)*x[1]*x[2]*x[3]*x[4]-(336/23)*x[1]*x[2]*x[3]*x[5]+(1716/23)*x[1]*x[2]*x[4]*x[5]+(899/69)*x[1]*x[3]*x[4]*x[5]+(192/23)*x[2]*x[3]*x[4]*x[5];
```

The examples are generated with the following Maple code

```
# Parameters
n := 4;  # Number of variables
d := 2;  # Degree
s := 5;  # Number of random points

roll := rand(-2 .. 2);   # Randon numbers generator

# s random points in R^n
points := [seq([seq(roll(), j = 1 .. n)], i = 1 .. s)];


# We define the set of monomials of degree d (stored in ctd) and
# the set of monomials of degree 2d (stored in ct2d).
polVars := [seq(x[i], i = 1 .. n)];
varSum := add(polVars[i], i = 1..nops(polVars)):
md := expand((varSum)^d):
cfs := coeffs(md, polVars, 'ctd'):
print("Monomials of degree d: ", ctd);
m2d := expand(varSum^(2*d)):
cfs := coeffs(m2d, polVars, 'ct2d'):
print("Monomials of degree 2d: ", ct2d);

monoms := [ctd];
Nd := nops(monoms);

# Build evaluation matrix: s x Nd
M := Matrix(s, Nd, (i,j) -> eval(monoms[j], [seq(polVars[k]=points[i][k], k=1..n)]) ):

# Nullspace: cubics vanishing at these s points
NS := NullSpace(M):

dim := nops(NS);

# Extract basis polynomials
basisPolys := [seq(add(NS[j][k]*monoms[k], k=1..Nd), j=1..dim)];

# The sums of squares
pp := expand(add(basisPolys[k]^2, k=1..dim));

# We verify uniqueness
out := exactSOS(pp, facial = "no", objFunction = "eig"):
eig(out[3]);

# We verify uniqueness
out := exactSOS(pp, facial = "no", objFunction = "eig"):
eig(out[3]);
```

<!-- add history, minimal number of squares, references, verification scripts, etc. -->
